# Power Automate C2: Stealth Living-Off-the-Cloud C2 Framework

## Description
PowerAutomate C2 is a framework designed to emulate "Living Off the Cloud" attacks, leveraging only legitimate functions in PowerAutomate.

The battlefield has shifted from the endpoint to the cloud in evolving cyber warfare. This shift can increase the wealth of useful information the cloud offers, making it a more lucrative target for attackers. This transition introduces a new tactic, "Living Off the Cloud," which has become increasingly prevalent in cyber-attacks.

PowerAutomate, a powerful cloud-based automation platform also known as the "New PowerShell", allows for the execution of these "Living Off the Cloud" attacks. PowerAutomate is particularly attractive to attackers as it enables stealth activities. One characteristic is a client-free execution which carries out an attack that leaves no logs on the client and completes entirely in the cloud. It ensures no traces are left on the endpoint, network devices, or within the Office 365 environment. Despite this, continuous access to PowerAutomate on the victim's user profile is required to execute and manage the flow of an attack. PowerAutomate provides a connector known as PowerAutomate Management to address this challenge. This connector allows for managing the flow itself, thus eliminating the need for persistent access to the victim's user profile.

In this presentation, we introduce the concept and demonstration of PowerAutomate C2, which utilizes the basic functions of PowerAutomate and exclusively employs the PowerAutomate Management connector. PowerAutomate C2 is built on a Python-based platform, enabling control over PowerAutomate's flow without a GUI-based low-code interface. This approach also facilitates the remote creation and deletion of flows with no logs, even after access to PowerAutomate is lost. For C2 communication, we have implemented support for HTTP(S) and storage services like Dropbox, enhancing the flexibility and stealth of the operation. We also alert the risk of improper permission to use PowerAutomate Management.

## Code
https://github.com/t-tani/pac2-dev
